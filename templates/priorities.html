{% extends "base.html" %}

{% block title %}Priorities - AI Briefing{% endblock %}

{% block content %}
<div class="container">
    <h1>Research Priorities</h1>
    <p class="page-description">
        Priorities boost article relevance during triage and generate additional NewsAPI queries during collection.
    </p>

    <div class="add-priority-form">
        <h2>Add Priority</h2>
        <form action="{{ url_for('add_priority') }}" method="post">
            <div class="form-group">
                <label for="title">Title</label>
                <input type="text" id="title" name="title" required
                       placeholder="e.g., LLM Agents for Testing">
            </div>
            <div class="form-group">
                <label for="description">Description (optional)</label>
                <textarea id="description" name="description" rows="2"
                          placeholder="What specifically interests you about this topic?"></textarea>
            </div>
            <button type="submit" class="btn btn-primary">Add Priority</button>
        </form>
    </div>

    {% if priorities %}
    <div class="priorities-list">
        {% for p in priorities %}
        <div class="priority-item {{ 'inactive' if not p.is_active }}">
            <div class="priority-header">
                <div class="priority-status">
                    <span class="status-indicator {{ 'active' if p.is_active else 'inactive' }}">
                        {{ '*' if p.is_active else 'o' }}
                    </span>
                </div>
                <div class="priority-content">
                    <h3>{{ p.title }}</h3>
                    {% if p.description %}
                    <p class="priority-description">{{ p.description }}</p>
                    {% endif %}
                </div>
                <div class="priority-actions">
                    <form action="{{ url_for('toggle_priority', priority_id=p.id) }}" method="post" class="inline-form">
                        <button type="submit" class="btn btn-small">
                            {{ 'Disable' if p.is_active else 'Enable' }}
                        </button>
                    </form>
                    <form action="{{ url_for('delete_priority', priority_id=p.id) }}" method="post" class="inline-form">
                        <button type="submit" class="btn btn-small btn-danger">Delete</button>
                    </form>
                </div>
            </div>

            <details class="edit-form">
                <summary>Edit</summary>
                <form action="{{ url_for('edit_priority', priority_id=p.id) }}" method="post">
                    <div class="form-group">
                        <label for="edit-title-{{ p.id }}">Title</label>
                        <input type="text" id="edit-title-{{ p.id }}" name="title" value="{{ p.title }}" required>
                    </div>
                    <div class="form-group">
                        <label for="edit-desc-{{ p.id }}">Description</label>
                        <textarea id="edit-desc-{{ p.id }}" name="description" rows="2">{{ p.description or '' }}</textarea>
                    </div>
                    <button type="submit" class="btn btn-primary btn-small">Save</button>
                </form>
            </details>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <div class="empty-state">
        <p>No priorities defined yet. Add one above to boost relevant articles.</p>
    </div>
    {% endif %}
</div>
{% endblock %}
